"use strict";var Po=Object.create;var ht=Object.defineProperty;var Co=Object.getOwnPropertyDescriptor;var Lo=Object.getOwnPropertyNames;var Ao=Object.getPrototypeOf,Ro=Object.prototype.hasOwnProperty;var M=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Oo=(t,e)=>{for(var r in e)ht(t,r,{get:e[r],enumerable:!0})},_r=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Lo(e))!Ro.call(t,s)&&s!==r&&ht(t,s,{get:()=>e[s],enumerable:!(n=Co(e,s))||n.enumerable});return t};var W=(t,e,r)=>(r=t!=null?Po(Ao(t)):{},_r(e||!t||!t.__esModule?ht(r,"default",{value:t,enumerable:!0}):r,t)),_o=t=>_r(ht({},"__esModule",{value:!0}),t);var Vr=M((Fa,Ur)=>{Ur.exports=Fr;Fr.sync=Do;var Nr=require("fs");function No(t,e){var r=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!r||(r=r.split(";"),r.indexOf("")!==-1))return!0;for(var n=0;n<r.length;n++){var s=r[n].toLowerCase();if(s&&t.substr(-s.length).toLowerCase()===s)return!0}return!1}function Dr(t,e,r){return!t.isSymbolicLink()&&!t.isFile()?!1:No(e,r)}function Fr(t,e,r){Nr.stat(t,function(n,s){r(n,n?!1:Dr(s,t,e))})}function Do(t,e){return Dr(Nr.statSync(t),t,e)}});var Wr=M((Ua,zr)=>{zr.exports=Br;Br.sync=Fo;var Mr=require("fs");function Br(t,e,r){Mr.stat(t,function(n,s){r(n,n?!1:Gr(s,e))})}function Fo(t,e){return Gr(Mr.statSync(t),e)}function Gr(t,e){return t.isFile()&&Uo(t,e)}function Uo(t,e){var r=t.mode,n=t.uid,s=t.gid,o=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),i=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),c=parseInt("100",8),u=parseInt("010",8),p=parseInt("001",8),E=c|u,g=r&p||r&u&&s===i||r&c&&n===o||r&E&&o===0;return g}});var jr=M((Ma,Hr)=>{var Va=require("fs"),gt;process.platform==="win32"||global.TESTING_WINDOWS?gt=Vr():gt=Wr();Hr.exports=zt;zt.sync=Vo;function zt(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,s){zt(t,e||{},function(o,i){o?s(o):n(i)})})}gt(t,e||{},function(n,s){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,s=!1),r(n,s)})}function Vo(t,e){try{return gt.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}});var Qr=M((Ba,Xr)=>{var Re=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Kr=require("path"),Mo=Re?";":":",Yr=jr(),Zr=t=>Object.assign(new Error(`not found: ${t}`),{code:"ENOENT"}),qr=(t,e)=>{let r=e.colon||Mo,n=t.match(/\//)||Re&&t.match(/\\/)?[""]:[...Re?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(r)],s=Re?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=Re?s.split(r):[""];return Re&&t.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:s}},Jr=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),e||(e={});let{pathEnv:n,pathExt:s,pathExtExe:o}=qr(t,e),i=[],c=p=>new Promise((E,g)=>{if(p===n.length)return e.all&&i.length?E(i):g(Zr(t));let C=n[p],T=/^".*"$/.test(C)?C.slice(1,-1):C,P=Kr.join(T,t),x=!T&&/^\.[\\\/]/.test(t)?t.slice(0,2)+P:P;E(u(x,p,0))}),u=(p,E,g)=>new Promise((C,T)=>{if(g===s.length)return C(c(E+1));let P=s[g];Yr(p+P,{pathExt:o},(x,b)=>{if(!x&&b)if(e.all)i.push(p+P);else return C(p+P);return C(u(p,E,g+1))})});return r?c(0).then(p=>r(null,p),r):c(0)},Bo=(t,e)=>{e=e||{};let{pathEnv:r,pathExt:n,pathExtExe:s}=qr(t,e),o=[];for(let i=0;i<r.length;i++){let c=r[i],u=/^".*"$/.test(c)?c.slice(1,-1):c,p=Kr.join(u,t),E=!u&&/^\.[\\\/]/.test(t)?t.slice(0,2)+p:p;for(let g=0;g<n.length;g++){let C=E+n[g];try{if(Yr.sync(C,{pathExt:s}))if(e.all)o.push(C);else return C}catch{}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw Zr(t)};Xr.exports=Jr;Jr.sync=Bo});var tn=M((Ga,Wt)=>{"use strict";var en=(t={})=>{let e=t.env||process.env;return(t.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};Wt.exports=en;Wt.exports.default=en});var on=M((za,sn)=>{"use strict";var rn=require("path"),Go=Qr(),zo=tn();function nn(t,e){let r=t.options.env||process.env,n=process.cwd(),s=t.options.cwd!=null,o=s&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(t.options.cwd)}catch{}let i;try{i=Go.sync(t.command,{path:r[zo({env:r})],pathExt:e?rn.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return i&&(i=rn.resolve(s?t.options.cwd:"",i)),i}function Wo(t){return nn(t)||nn(t,!0)}sn.exports=Wo});var an=M((Wa,jt)=>{"use strict";var Ht=/([()\][%!^"`<>&|;, *?])/g;function Ho(t){return t=t.replace(Ht,"^$1"),t}function jo(t,e){return t=`${t}`,t=t.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),t=t.replace(/(?=(\\+?)?)\1$/,"$1$1"),t=`"${t}"`,t=t.replace(Ht,"^$1"),e&&(t=t.replace(Ht,"^$1")),t}jt.exports.command=Ho;jt.exports.argument=jo});var ln=M((Ha,cn)=>{"use strict";cn.exports=/^#!(.*)/});var dn=M((ja,un)=>{"use strict";var Ko=ln();un.exports=(t="")=>{let e=t.match(Ko);if(!e)return null;let[r,n]=e[0].replace(/#! ?/,"").split(" "),s=r.split("/").pop();return s==="env"?n:n?`${s} ${n}`:s}});var mn=M((Ka,fn)=>{"use strict";var Kt=require("fs"),Yo=dn();function Zo(t){let r=Buffer.alloc(150),n;try{n=Kt.openSync(t,"r"),Kt.readSync(n,r,0,150,0),Kt.closeSync(n)}catch{}return Yo(r.toString())}fn.exports=Zo});var yn=M((Ya,gn)=>{"use strict";var qo=require("path"),pn=on(),hn=an(),Jo=mn(),Xo=process.platform==="win32",Qo=/\.(?:com|exe)$/i,ei=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function ti(t){t.file=pn(t);let e=t.file&&Jo(t.file);return e?(t.args.unshift(t.file),t.command=e,pn(t)):t.file}function ri(t){if(!Xo)return t;let e=ti(t),r=!Qo.test(e);if(t.options.forceShell||r){let n=ei.test(e);t.command=qo.normalize(t.command),t.command=hn.command(t.command),t.args=t.args.map(o=>hn.argument(o,n));let s=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${s}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}function ni(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null),e=e?e.slice(0):[],r=Object.assign({},r);let n={command:t,args:e,options:r,file:void 0,original:{command:t,args:e}};return r.shell?n:ri(n)}gn.exports=ni});var En=M((Za,bn)=>{"use strict";var Yt=process.platform==="win32";function Zt(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}function si(t,e){if(!Yt)return;let r=t.emit;t.emit=function(n,s){if(n==="exit"){let o=wn(s,e);if(o)return r.call(t,"error",o)}return r.apply(t,arguments)}}function wn(t,e){return Yt&&t===1&&!e.file?Zt(e.original,"spawn"):null}function oi(t,e){return Yt&&t===1&&!e.file?Zt(e.original,"spawnSync"):null}bn.exports={hookChildProcess:si,verifyENOENT:wn,verifyENOENTSync:oi,notFoundError:Zt}});var In=M((qa,Oe)=>{"use strict";var Sn=require("child_process"),qt=yn(),Jt=En();function xn(t,e,r){let n=qt(t,e,r),s=Sn.spawn(n.command,n.args,n.options);return Jt.hookChildProcess(s,n),s}function ii(t,e,r){let n=qt(t,e,r),s=Sn.spawnSync(n.command,n.args,n.options);return s.error=s.error||Jt.verifyENOENTSync(s.status,n),s}Oe.exports=xn;Oe.exports.spawn=xn;Oe.exports.sync=ii;Oe.exports._parse=qt;Oe.exports._enoent=Jt});var Dn=M((hc,Et)=>{Et.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&Et.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&Et.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var Bn=M((gc,Fe)=>{var N=global.process,xe=function(t){return t&&typeof t=="object"&&typeof t.removeListener=="function"&&typeof t.emit=="function"&&typeof t.reallyExit=="function"&&typeof t.listeners=="function"&&typeof t.kill=="function"&&typeof t.pid=="number"&&typeof t.on=="function"};xe(N)?(Fn=require("assert"),Ne=Dn(),Un=/^win/i.test(N.platform),Je=require("events"),typeof Je!="function"&&(Je=Je.EventEmitter),N.__signal_exit_emitter__?B=N.__signal_exit_emitter__:(B=N.__signal_exit_emitter__=new Je,B.count=0,B.emitted={}),B.infinite||(B.setMaxListeners(1/0),B.infinite=!0),Fe.exports=function(t,e){if(!xe(global.process))return function(){};Fn.equal(typeof t,"function","a callback must be provided for exit handler"),De===!1&&rr();var r="exit";e&&e.alwaysLast&&(r="afterexit");var n=function(){B.removeListener(r,t),B.listeners("exit").length===0&&B.listeners("afterexit").length===0&&St()};return B.on(r,t),n},St=function(){!De||!xe(global.process)||(De=!1,Ne.forEach(function(e){try{N.removeListener(e,xt[e])}catch{}}),N.emit=It,N.reallyExit=nr,B.count-=1)},Fe.exports.unload=St,Ie=function(e,r,n){B.emitted[e]||(B.emitted[e]=!0,B.emit(e,r,n))},xt={},Ne.forEach(function(t){xt[t]=function(){if(xe(global.process)){var r=N.listeners(t);r.length===B.count&&(St(),Ie("exit",null,t),Ie("afterexit",null,t),Un&&t==="SIGHUP"&&(t="SIGINT"),N.kill(N.pid,t))}}}),Fe.exports.signals=function(){return Ne},De=!1,rr=function(){De||!xe(global.process)||(De=!0,B.count+=1,Ne=Ne.filter(function(e){try{return N.on(e,xt[e]),!0}catch{return!1}}),N.emit=Mn,N.reallyExit=Vn)},Fe.exports.load=rr,nr=N.reallyExit,Vn=function(e){xe(global.process)&&(N.exitCode=e||0,Ie("exit",N.exitCode,null),Ie("afterexit",N.exitCode,null),nr.call(N,N.exitCode))},It=N.emit,Mn=function(e,r){if(e==="exit"&&xe(global.process)){r!==void 0&&(N.exitCode=r);var n=It.apply(this,arguments);return Ie("exit",N.exitCode,null),Ie("afterexit",N.exitCode,null),n}else return It.apply(this,arguments)}):Fe.exports=function(){return function(){}};var Fn,Ne,Un,Je,B,St,Ie,xt,De,rr,nr,Vn,It,Mn});var Jn=M((bc,qn)=>{"use strict";var{PassThrough:Li}=require("stream");qn.exports=t=>{t={...t};let{array:e}=t,{encoding:r}=t,n=r==="buffer",s=!1;e?s=!(r||n):r=r||"utf8",n&&(r=null);let o=new Li({objectMode:s});r&&o.setEncoding(r);let i=0,c=[];return o.on("data",u=>{c.push(u),s?i=c.length:i+=u.length}),o.getBufferedValue=()=>e?c:n?Buffer.concat(c,i):c.join(""),o.getBufferedLength=()=>i,o}});var Xn=M((Ec,Xe)=>{"use strict";var{constants:Ai}=require("buffer"),Ri=require("stream"),{promisify:Oi}=require("util"),_i=Jn(),Ni=Oi(Ri.pipeline),vt=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function sr(t,e){if(!t)throw new Error("Expected a stream");e={maxBuffer:1/0,...e};let{maxBuffer:r}=e,n=_i(e);return await new Promise((s,o)=>{let i=c=>{c&&n.getBufferedLength()<=Ai.MAX_LENGTH&&(c.bufferedData=n.getBufferedValue()),o(c)};(async()=>{try{await Ni(t,n),s()}catch(c){i(c)}})(),n.on("data",()=>{n.getBufferedLength()>r&&i(new vt)})}),n.getBufferedValue()}Xe.exports=sr;Xe.exports.buffer=(t,e)=>sr(t,{...e,encoding:"buffer"});Xe.exports.array=(t,e)=>sr(t,{...e,array:!0});Xe.exports.MaxBufferError=vt});var es=M((Sc,Qn)=>{"use strict";var{PassThrough:Di}=require("stream");Qn.exports=function(){var t=[],e=new Di({objectMode:!0});return e.setMaxListeners(0),e.add=r,e.isEmpty=n,e.on("unpipe",s),Array.prototype.slice.call(arguments).forEach(r),e;function r(o){return Array.isArray(o)?(o.forEach(r),this):(t.push(o),o.once("end",s.bind(null,o)),o.once("error",e.emit.bind(e,"error")),o.pipe(e,{end:!1}),this)}function n(){return t.length==0}function s(o){t=t.filter(function(i){return i!==o}),!t.length&&e.readable&&e.end()}}});var Ts=M((il,vs)=>{var Q=require("fs"),Ki=require("util"),Me=require("path"),br=require("events"),Es=require("zlib"),Is=require("stream"),l={LOCHDR:30,LOCSIG:67324752,LOCVER:4,LOCFLG:6,LOCHOW:8,LOCTIM:10,LOCCRC:14,LOCSIZ:18,LOCLEN:22,LOCNAM:26,LOCEXT:28,EXTSIG:134695760,EXTHDR:16,EXTCRC:4,EXTSIZ:8,EXTLEN:12,CENHDR:46,CENSIG:33639248,CENVEM:4,CENVER:6,CENFLG:8,CENHOW:10,CENTIM:12,CENCRC:16,CENSIZ:20,CENLEN:24,CENNAM:28,CENEXT:30,CENCOM:32,CENDSK:34,CENATT:36,CENATX:38,CENOFF:42,ENDHDR:22,ENDSIG:101010256,ENDSIGFIRST:80,ENDSUB:8,ENDTOT:10,ENDSIZ:12,ENDOFF:16,ENDCOM:20,MAXFILECOMMENT:65535,ENDL64HDR:20,ENDL64SIG:117853008,ENDL64SIGFIRST:80,ENDL64OFS:8,END64HDR:56,END64SIG:101075792,END64SIGFIRST:80,END64SUB:24,END64TOT:32,END64SIZ:40,END64OFF:48,STORED:0,SHRUNK:1,REDUCED1:2,REDUCED2:3,REDUCED3:4,REDUCED4:5,IMPLODED:6,DEFLATED:8,ENHANCED_DEFLATED:9,PKWARE:10,BZIP2:12,LZMA:14,IBM_TERSE:18,IBM_LZ77:19,FLG_ENC:0,FLG_COMP1:1,FLG_COMP2:2,FLG_DESC:4,FLG_ENH:8,FLG_STR:16,FLG_LNG:1024,FLG_MSK:4096,FLG_ENTRY_ENC:1,EF_ID:0,EF_SIZE:2,ID_ZIP64:1,ID_AVINFO:7,ID_PFS:8,ID_OS2:9,ID_NTFS:10,ID_OPENVMS:12,ID_UNIX:13,ID_FORK:14,ID_PATCH:15,ID_X509_PKCS7:20,ID_X509_CERTID_F:21,ID_X509_CERTID_C:22,ID_STRONGENC:23,ID_RECORD_MGT:24,ID_X509_PKCS7_RL:25,ID_IBM1:101,ID_IBM2:102,ID_POSZIP:18064,EF_ZIP64_OR_32:4294967295,EF_ZIP64_OR_16:65535},ye=function(t){let e,r,n,s,o,i,u=this,p=t.storeEntries!==!1?{}:null,E=t.file,g=t.nameEncoding?new TextDecoder(t.nameEncoding):null;C();function C(){t.fd?(e=t.fd,T()):Q.open(E,"r",(a,f)=>{if(a)return u.emit("error",a);e=f,T()})}function T(){Q.fstat(e,(a,f)=>{if(a)return u.emit("error",a);r=f.size,n=t.chunkSize||Math.round(r/1e3),n=Math.max(Math.min(n,Math.min(128*1024,r)),Math.min(1024,r)),x()})}function P(a,f){if(a||!f)return u.emit("error",a||new Error("Archive read error"));let d=s.lastPos,m=d-s.win.position,k=s.win.buffer,S=s.minPos;for(;--d>=S&&--m>=0;)if(k.length-m>=4&&k[m]===s.firstByte&&k.readUInt32LE(m)===s.sig){s.lastBufferPosition=m,s.lastBytesRead=f,s.complete();return}if(d===S)return u.emit("error",new Error("Bad archive"));if(s.lastPos=d+1,s.chunkSize*=2,d<=S)return u.emit("error",new Error("Bad archive"));let D=Math.min(s.chunkSize,d-S);s.win.expandLeft(D,P)}function x(){let a=Math.min(l.ENDHDR+l.MAXFILECOMMENT,r);s={win:new Ct(e),totalReadLength:a,minPos:r-a,lastPos:r,chunkSize:Math.min(1024,n),firstByte:l.ENDSIGFIRST,sig:l.ENDSIG,complete:b},s.win.read(r-s.chunkSize,s.chunkSize,P)}function b(){let a=s.win.buffer,f=s.lastBufferPosition;try{o=new mr,o.read(a.slice(f,f+l.ENDHDR)),o.headerOffset=s.win.position+f,o.commentLength?u.comment=a.slice(f+l.ENDHDR,f+l.ENDHDR+o.commentLength).toString():u.comment=null,u.entriesCount=o.volumeEntries,u.centralDirectory=o,o.volumeEntries===l.EF_ZIP64_OR_16&&o.totalEntries===l.EF_ZIP64_OR_16||o.size===l.EF_ZIP64_OR_32||o.offset===l.EF_ZIP64_OR_32?h():(s={},L())}catch(d){u.emit("error",d)}}function h(){let a=l.ENDL64HDR;s.lastBufferPosition>a?(s.lastBufferPosition-=a,y()):(s={win:s.win,totalReadLength:a,minPos:s.win.position-a,lastPos:s.win.position,chunkSize:s.chunkSize,firstByte:l.ENDL64SIGFIRST,sig:l.ENDL64SIG,complete:y},s.win.read(s.lastPos-s.chunkSize,s.chunkSize,P))}function y(){let a=s.win.buffer,f=new pr;f.read(a.slice(s.lastBufferPosition,s.lastBufferPosition+l.ENDL64HDR));let d=r-f.headerOffset;s={win:s.win,totalReadLength:d,minPos:f.headerOffset,lastPos:s.lastPos,chunkSize:s.chunkSize,firstByte:l.END64SIGFIRST,sig:l.END64SIG,complete:$},s.win.read(r-s.chunkSize,s.chunkSize,P)}function $(){let a=s.win.buffer,f=new hr;f.read(a.slice(s.lastBufferPosition,s.lastBufferPosition+l.END64HDR)),u.centralDirectory.volumeEntries=f.volumeEntries,u.centralDirectory.totalEntries=f.totalEntries,u.centralDirectory.size=f.size,u.centralDirectory.offset=f.offset,u.entriesCount=f.volumeEntries,s={},L()}function L(){s={win:new Ct(e),pos:o.offset,chunkSize:n,entriesLeft:o.volumeEntries},s.win.read(s.pos,Math.min(n,r-s.pos),A)}function A(a,f){if(a||!f)return u.emit("error",a||new Error("Entries read error"));let d=s.pos-s.win.position,m=s.entry,k=s.win.buffer,S=k.length;try{for(;s.entriesLeft>0;){m||(m=new gr,m.readHeader(k,d),m.headerOffset=s.win.position+d,s.entry=m,s.pos+=l.CENHDR,d+=l.CENHDR);let D=m.fnameLen+m.extraLen+m.comLen,U=D+(s.entriesLeft>1?l.CENHDR:0);if(S-d<U){s.win.moveRight(n,A,d),s.move=!0;return}m.read(k,d,g),t.skipEntryNameValidation||m.validateName(),p&&(p[m.name]=m),u.emit("entry",m),s.entry=m=null,s.entriesLeft--,s.pos+=D,d+=D}u.emit("ready")}catch(D){u.emit("error",D)}}function O(){if(!p)throw new Error("storeEntries disabled")}Object.defineProperty(this,"ready",{get(){return!1}}),this.entry=function(a){return O(),p[a]},this.entries=function(){return O(),p},this.stream=function(a,f){return this.openEntry(a,(d,m)=>{if(d)return f(d);let k=ae(m),S=new yr(e,k,m.compressedSize);if(m.method!==l.STORED)if(m.method===l.DEFLATED)S=S.pipe(Es.createInflateRaw());else return f(new Error("Unknown compression method: "+m.method));Ae(m)&&(S=S.pipe(new wr(S,m.crc,m.size))),f(null,S)},!1)},this.entryDataSync=function(a){let f=null;if(this.openEntry(a,(m,k)=>{f=m,a=k},!0),f)throw f;let d=Buffer.alloc(a.compressedSize);if(new he(e,d,0,a.compressedSize,ae(a),m=>{f=m}).read(!0),f)throw f;if(a.method!==l.STORED)if(a.method===l.DEFLATED||a.method===l.ENHANCED_DEFLATED)d=Es.inflateRawSync(d);else throw new Error("Unknown compression method: "+a.method);if(d.length!==a.size)throw new Error("Invalid size");return Ae(a)&&new Lt(a.crc,a.size).data(d),d},this.openEntry=function(a,f,d){if(typeof a=="string"&&(O(),a=p[a],!a))return f(new Error("Entry not found"));if(!a.isFile)return f(new Error("Entry is not file"));if(!e)return f(new Error("Archive closed"));let m=Buffer.alloc(l.LOCHDR);new he(e,m,0,m.length,a.offset,k=>{if(k)return f(k);let S;try{a.readDataHeader(m),a.encrypted&&(S=new Error("Entry encrypted"))}catch(D){S=D}f(S,a)}).read(d)};function ae(a){return a.offset+l.LOCHDR+a.fnameLen+a.extraLen}function Ae(a){return(a.flags&8)!==8}function Ye(a,f,d){u.stream(a,(m,k)=>{if(m)d(m);else{let S,D;k.on("error",U=>{D=U,S&&(k.unpipe(S),S.close(()=>{d(U)}))}),Q.open(f,"w",(U,te)=>{if(U)return d(U);if(D){Q.close(e,()=>{d(D)});return}S=Q.createWriteStream(f,{fd:te}),S.on("finish",()=>{u.emit("extract",a,f),D||d()}),k.pipe(S)})}})}function pt(a,f,d){if(!f.length)return d();let m=f.shift();m=Me.join(a,Me.join(...m)),Q.mkdir(m,{recursive:!0},k=>{if(k&&k.code!=="EEXIST")return d(k);pt(a,f,d)})}function X(a,f,d,m,k){if(!d.length)return m(null,k);let S=d.shift(),D=Me.join(a,S.name.replace(f,""));Ye(S,D,U=>{if(U)return m(U,k);X(a,f,d,m,k+1)})}this.extract=function(a,f,d){let m=a||"";if(typeof a=="string"&&(a=this.entry(a),a?m=a.name:m.length&&m[m.length-1]!=="/"&&(m+="/")),!a||a.isDirectory){let k=[],S=[],D={};for(let U in p)if(Object.prototype.hasOwnProperty.call(p,U)&&U.lastIndexOf(m,0)===0){let te=U.replace(m,""),Or=p[U];if(Or.isFile&&(k.push(Or),te=Me.dirname(te)),te&&!D[te]&&te!=="."){D[te]=!0;let de=te.split("/").filter(Ze=>Ze);for(de.length&&S.push(de);de.length>1;){de=de.slice(0,de.length-1);let Ze=de.join("/");if(D[Ze]||Ze===".")break;D[Ze]=!0,S.push(de)}}}S.sort((U,te)=>U.length-te.length),S.length?pt(f,S,U=>{U?d(U):X(f,m,k,d,0)}):X(f,m,k,d,0)}else Q.stat(f,(k,S)=>{S&&S.isDirectory()?Ye(a,Me.join(f,Me.basename(a.name)),d):Ye(a,f,d)})},this.close=function(a){i||!e?(i=!0,a&&a()):(i=!0,Q.close(e,f=>{e=null,a&&a(f)}))};let j=br.EventEmitter.prototype.emit;this.emit=function(...a){if(!i)return j.call(this,...a)}};ye.setFs=function(t){Q=t};ye.debugLog=(...t)=>{ye.debug&&console.log(...t)};Ki.inherits(ye,br.EventEmitter);var pe=Symbol("zip");ye.async=class extends br.EventEmitter{constructor(e){super();let r=new ye(e);r.on("entry",n=>this.emit("entry",n)),r.on("extract",(n,s)=>this.emit("extract",n,s)),this[pe]=new Promise((n,s)=>{r.on("ready",()=>{r.removeListener("error",s),n(r)}),r.on("error",s)})}get entriesCount(){return this[pe].then(e=>e.entriesCount)}get comment(){return this[pe].then(e=>e.comment)}async entry(e){return(await this[pe]).entry(e)}async entries(){return(await this[pe]).entries()}async stream(e){let r=await this[pe];return new Promise((n,s)=>{r.stream(e,(o,i)=>{o?s(o):n(i)})})}async entryData(e){let r=await this.stream(e);return new Promise((n,s)=>{let o=[];r.on("data",i=>o.push(i)),r.on("end",()=>{n(Buffer.concat(o))}),r.on("error",i=>{r.removeAllListeners("end"),s(i)})})}async extract(e,r){let n=await this[pe];return new Promise((s,o)=>{n.extract(e,r,(i,c)=>{i?o(i):s(c)})})}async close(){let e=await this[pe];return new Promise((r,n)=>{e.close(s=>{s?n(s):r()})})}};var mr=class{read(e){if(e.length!==l.ENDHDR||e.readUInt32LE(0)!==l.ENDSIG)throw new Error("Invalid central directory");this.volumeEntries=e.readUInt16LE(l.ENDSUB),this.totalEntries=e.readUInt16LE(l.ENDTOT),this.size=e.readUInt32LE(l.ENDSIZ),this.offset=e.readUInt32LE(l.ENDOFF),this.commentLength=e.readUInt16LE(l.ENDCOM)}},pr=class{read(e){if(e.length!==l.ENDL64HDR||e.readUInt32LE(0)!==l.ENDL64SIG)throw new Error("Invalid zip64 central directory locator");this.headerOffset=ge(e,l.ENDSUB)}},hr=class{read(e){if(e.length!==l.END64HDR||e.readUInt32LE(0)!==l.END64SIG)throw new Error("Invalid central directory");this.volumeEntries=ge(e,l.END64SUB),this.totalEntries=ge(e,l.END64TOT),this.size=ge(e,l.END64SIZ),this.offset=ge(e,l.END64OFF)}},gr=class{readHeader(e,r){if(e.length<r+l.CENHDR||e.readUInt32LE(r)!==l.CENSIG)throw new Error("Invalid entry header");this.verMade=e.readUInt16LE(r+l.CENVEM),this.version=e.readUInt16LE(r+l.CENVER),this.flags=e.readUInt16LE(r+l.CENFLG),this.method=e.readUInt16LE(r+l.CENHOW);let n=e.readUInt16LE(r+l.CENTIM),s=e.readUInt16LE(r+l.CENTIM+2);this.time=Ss(n,s),this.crc=e.readUInt32LE(r+l.CENCRC),this.compressedSize=e.readUInt32LE(r+l.CENSIZ),this.size=e.readUInt32LE(r+l.CENLEN),this.fnameLen=e.readUInt16LE(r+l.CENNAM),this.extraLen=e.readUInt16LE(r+l.CENEXT),this.comLen=e.readUInt16LE(r+l.CENCOM),this.diskStart=e.readUInt16LE(r+l.CENDSK),this.inattr=e.readUInt16LE(r+l.CENATT),this.attr=e.readUInt32LE(r+l.CENATX),this.offset=e.readUInt32LE(r+l.CENOFF)}readDataHeader(e){if(e.readUInt32LE(0)!==l.LOCSIG)throw new Error("Invalid local header");this.version=e.readUInt16LE(l.LOCVER),this.flags=e.readUInt16LE(l.LOCFLG),this.method=e.readUInt16LE(l.LOCHOW);let r=e.readUInt16LE(l.LOCTIM),n=e.readUInt16LE(l.LOCTIM+2);this.time=Ss(r,n),this.crc=e.readUInt32LE(l.LOCCRC)||this.crc;let s=e.readUInt32LE(l.LOCSIZ);s&&s!==l.EF_ZIP64_OR_32&&(this.compressedSize=s);let o=e.readUInt32LE(l.LOCLEN);o&&o!==l.EF_ZIP64_OR_32&&(this.size=o),this.fnameLen=e.readUInt16LE(l.LOCNAM),this.extraLen=e.readUInt16LE(l.LOCEXT)}read(e,r,n){let s=e.slice(r,r+=this.fnameLen);this.name=n?n.decode(new Uint8Array(s)):s.toString("utf8");let o=e[r-1];this.isDirectory=o===47||o===92,this.extraLen&&(this.readExtra(e,r),r+=this.extraLen),this.comment=this.comLen?e.slice(r,r+this.comLen).toString():null}validateName(){if(/\\|^\w+:|^\/|(^|\/)\.\.(\/|$)/.test(this.name))throw new Error("Malicious entry: "+this.name)}readExtra(e,r){let n,s,o=r+this.extraLen;for(;r<o;)n=e.readUInt16LE(r),r+=2,s=e.readUInt16LE(r),r+=2,l.ID_ZIP64===n&&this.parseZip64Extra(e,r,s),r+=s}parseZip64Extra(e,r,n){n>=8&&this.size===l.EF_ZIP64_OR_32&&(this.size=ge(e,r),r+=8,n-=8),n>=8&&this.compressedSize===l.EF_ZIP64_OR_32&&(this.compressedSize=ge(e,r),r+=8,n-=8),n>=8&&this.offset===l.EF_ZIP64_OR_32&&(this.offset=ge(e,r),r+=8,n-=8),n>=4&&this.diskStart===l.EF_ZIP64_OR_16&&(this.diskStart=e.readUInt32LE(r))}get encrypted(){return(this.flags&l.FLG_ENTRY_ENC)===l.FLG_ENTRY_ENC}get isFile(){return!this.isDirectory}},he=class{constructor(e,r,n,s,o,i){this.fd=e,this.buffer=r,this.offset=n,this.length=s,this.position=o,this.callback=i,this.bytesRead=0,this.waiting=!1}read(e){ye.debugLog("read",this.position,this.bytesRead,this.length,this.offset),this.waiting=!0;let r;if(e){let n=0;try{n=Q.readSync(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead)}catch(s){r=s}this.readCallback(e,r,r?n:null)}else Q.read(this.fd,this.buffer,this.offset+this.bytesRead,this.length-this.bytesRead,this.position+this.bytesRead,this.readCallback.bind(this,e))}readCallback(e,r,n){if(typeof n=="number"&&(this.bytesRead+=n),r||!n||this.bytesRead===this.length)return this.waiting=!1,this.callback(r,this.bytesRead);this.read(e)}},Ct=class{constructor(e){this.position=0,this.buffer=Buffer.alloc(0),this.fd=e,this.fsOp=null}checkOp(){if(this.fsOp&&this.fsOp.waiting)throw new Error("Operation in progress")}read(e,r,n){this.checkOp(),this.buffer.length<r&&(this.buffer=Buffer.alloc(r)),this.position=e,this.fsOp=new he(this.fd,this.buffer,0,r,this.position,n).read()}expandLeft(e,r){this.checkOp(),this.buffer=Buffer.concat([Buffer.alloc(e),this.buffer]),this.position-=e,this.position<0&&(this.position=0),this.fsOp=new he(this.fd,this.buffer,0,e,this.position,r).read()}expandRight(e,r){this.checkOp();let n=this.buffer.length;this.buffer=Buffer.concat([this.buffer,Buffer.alloc(e)]),this.fsOp=new he(this.fd,this.buffer,n,e,this.position+n,r).read()}moveRight(e,r,n){this.checkOp(),n?this.buffer.copy(this.buffer,0,n):n=0,this.position+=n,this.fsOp=new he(this.fd,this.buffer,this.buffer.length-n,n,this.position+this.buffer.length-n,r).read()}},yr=class extends Is.Readable{constructor(e,r,n){super(),this.fd=e,this.offset=r,this.length=n,this.pos=0,this.readCallback=this.readCallback.bind(this)}_read(e){let r=Buffer.alloc(Math.min(e,this.length-this.pos));r.length?Q.read(this.fd,r,0,r.length,this.offset+this.pos,this.readCallback):this.push(null)}readCallback(e,r,n){this.pos+=r,e?(this.emit("error",e),this.push(null)):r?(r!==n.length&&(n=n.slice(0,r)),this.push(n)):this.push(null)}},wr=class extends Is.Transform{constructor(e,r,n){super(),this.verify=new Lt(r,n),e.on("error",s=>{this.emit("error",s)})}_transform(e,r,n){let s;try{this.verify.data(e)}catch(o){s=o}n(s,e)}},Lt=class t{constructor(e,r){this.crc=e,this.size=r,this.state={crc:-1,size:0}}data(e){let r=t.getCrcTable(),n=this.state.crc,s=0,o=e.length;for(;--o>=0;)n=r[(n^e[s++])&255]^n>>>8;if(this.state.crc=n,this.state.size+=e.length,this.state.size>=this.size){let i=Buffer.alloc(4);if(i.writeInt32LE(~this.state.crc&4294967295,0),n=i.readUInt32LE(0),n!==this.crc)throw new Error("Invalid CRC");if(this.state.size!==this.size)throw new Error("Invalid size")}}static getCrcTable(){let e=t.crcTable;if(!e){t.crcTable=e=[];let r=Buffer.alloc(4);for(let n=0;n<256;n++){let s=n;for(let o=8;--o>=0;)(s&1)!==0?s=3988292384^s>>>1:s=s>>>1;s<0&&(r.writeInt32LE(s,0),s=r.readUInt32LE(0)),e[n]=s}}return e}};function Ss(t,e){let r=xs(t,16),n=xs(e,16),s={h:parseInt(r.slice(0,5).join(""),2),m:parseInt(r.slice(5,11).join(""),2),s:parseInt(r.slice(11,16).join(""),2)*2,Y:parseInt(n.slice(0,7).join(""),2)+1980,M:parseInt(n.slice(7,11).join(""),2),D:parseInt(n.slice(11,16).join(""),2)},o=[s.Y,s.M,s.D].join("-")+" "+[s.h,s.m,s.s].join(":")+" GMT+0";return new Date(o).getTime()}function xs(t,e){let r=(t>>>0).toString(2);for(;r.length<e;)r="0"+r;return r.split("")}function ge(t,e){return t.readUInt32LE(e+4)*4294967296+t.readUInt32LE(e)}vs.exports=ye});var Na={};Oo(Na,{default:()=>_a});module.exports=_o(Na);var Y=require("@raycast/api");var Le=require("react");var F=require("@raycast/api");var ls=require("node:buffer"),us=W(require("node:path"),1),ur=W(require("node:child_process"),1),Qe=W(require("node:process"),1),ds=W(In(),1);function Xt(t){let e=typeof t=="string"?`
`:10,r=typeof t=="string"?"\r":13;return t[t.length-1]===e&&(t=t.slice(0,-1)),t[t.length-1]===r&&(t=t.slice(0,-1)),t}var qe=W(require("node:process"),1),_e=W(require("node:path"),1),vn=W(require("node:url"),1);function yt(t={}){let{env:e=process.env,platform:r=process.platform}=t;return r!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"}function ai(t={}){let{cwd:e=qe.default.cwd(),path:r=qe.default.env[yt()],execPath:n=qe.default.execPath}=t,s,o=e instanceof URL?vn.default.fileURLToPath(e):e,i=_e.default.resolve(o),c=[];for(;s!==i;)c.push(_e.default.join(i,"node_modules/.bin")),s=i,i=_e.default.resolve(i,"..");return c.push(_e.default.resolve(o,n,"..")),[...c,r].join(_e.default.delimiter)}function Tn({env:t=qe.default.env,...e}={}){t={...t};let r=yt({env:t});return e.path=t[r],t[r]=ai(e),t}var ci=(t,e,r,n)=>{if(r==="length"||r==="prototype"||r==="arguments"||r==="caller")return;let s=Object.getOwnPropertyDescriptor(t,r),o=Object.getOwnPropertyDescriptor(e,r);!li(s,o)&&n||Object.defineProperty(t,r,o)},li=function(t,e){return t===void 0||t.configurable||t.writable===e.writable&&t.enumerable===e.enumerable&&t.configurable===e.configurable&&(t.writable||t.value===e.value)},ui=(t,e)=>{let r=Object.getPrototypeOf(e);r!==Object.getPrototypeOf(t)&&Object.setPrototypeOf(t,r)},di=(t,e)=>`/* Wrapped ${t}*/
${e}`,fi=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),mi=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),pi=(t,e,r)=>{let n=r===""?"":`with ${r.trim()}() `,s=di.bind(null,n,e.toString());Object.defineProperty(s,"name",mi),Object.defineProperty(t,"toString",{...fi,value:s})};function Qt(t,e,{ignoreNonConfigurable:r=!1}={}){let{name:n}=t;for(let s of Reflect.ownKeys(e))ci(t,e,s,r);return ui(t,e),pi(t,e,n),t}var wt=new WeakMap,$n=(t,e={})=>{if(typeof t!="function")throw new TypeError("Expected a function");let r,n=0,s=t.displayName||t.name||"<anonymous>",o=function(...i){if(wt.set(o,++n),n===1)r=t.apply(this,i),t=null;else if(e.throw===!0)throw new Error(`Function \`${s}\` can only be called once`);return r};return Qt(o,t),wt.set(o,n),o};$n.callCount=t=>{if(!wt.has(t))throw new Error(`The given function \`${t.name}\` is not wrapped by the \`onetime\` package`);return wt.get(t)};var kn=$n;var On=require("node:os");var Pn=function(){let t=Ln-Cn+1;return Array.from({length:t},hi)},hi=function(t,e){return{name:`SIGRT${e+1}`,number:Cn+e,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},Cn=34,Ln=64;var Rn=require("node:os");var An=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];var er=function(){let t=Pn();return[...An,...t].map(gi)},gi=function({name:t,number:e,description:r,action:n,forced:s=!1,standard:o}){let{signals:{[t]:i}}=Rn.constants,c=i!==void 0;return{name:t,number:c?i:e,description:r,supported:c,action:n,forced:s,standard:o}};var yi=function(){let t=er();return Object.fromEntries(t.map(wi))},wi=function({name:t,number:e,description:r,supported:n,action:s,forced:o,standard:i}){return[t,{name:t,number:e,description:r,supported:n,action:s,forced:o,standard:i}]},_n=yi(),bi=function(){let t=er(),e=65,r=Array.from({length:e},(n,s)=>Ei(s,t));return Object.assign({},...r)},Ei=function(t,e){let r=Si(t,e);if(r===void 0)return{};let{name:n,description:s,supported:o,action:i,forced:c,standard:u}=r;return{[t]:{name:n,number:t,description:s,supported:o,action:i,forced:c,standard:u}}},Si=function(t,e){let r=e.find(({name:n})=>On.constants.signals[n]===t);return r!==void 0?r:e.find(n=>n.number===t)},uc=bi();var xi=({timedOut:t,timeout:e,errorCode:r,signal:n,signalDescription:s,exitCode:o,isCanceled:i})=>t?`timed out after ${e} milliseconds`:i?"was canceled":r!==void 0?`failed with ${r}`:n!==void 0?`was killed with ${n} (${s})`:o!==void 0?`failed with exit code ${o}`:"failed",tr=({stdout:t,stderr:e,all:r,error:n,signal:s,exitCode:o,command:i,escapedCommand:c,timedOut:u,isCanceled:p,killed:E,parsed:{options:{timeout:g}}})=>{o=o===null?void 0:o,s=s===null?void 0:s;let C=s===void 0?void 0:_n[s].description,T=n&&n.code,x=`Command ${xi({timedOut:u,timeout:g,errorCode:T,signal:s,signalDescription:C,exitCode:o,isCanceled:p})}: ${i}`,b=Object.prototype.toString.call(n)==="[object Error]",h=b?`${x}
${n.message}`:x,y=[h,e,t].filter(Boolean).join(`
`);return b?(n.originalMessage=n.message,n.message=y):n=new Error(y),n.shortMessage=h,n.command=i,n.escapedCommand=c,n.exitCode=o,n.signal=s,n.signalDescription=C,n.stdout=t,n.stderr=e,r!==void 0&&(n.all=r),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=!!u,n.isCanceled=p,n.killed=E&&!u,n};var bt=["stdin","stdout","stderr"],Ii=t=>bt.some(e=>t[e]!==void 0),Nn=t=>{if(!t)return;let{stdio:e}=t;if(e===void 0)return bt.map(n=>t[n]);if(Ii(t))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${bt.map(n=>`\`${n}\``).join(", ")}`);if(typeof e=="string")return e;if(!Array.isArray(e))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof e}\``);let r=Math.max(e.length,bt.length);return Array.from({length:r},(n,s)=>e[s])};var Gn=W(require("node:os"),1),zn=W(Bn(),1),vi=1e3*5,Wn=(t,e="SIGTERM",r={})=>{let n=t(e);return Ti(t,e,r,n),n},Ti=(t,e,r,n)=>{if(!$i(e,r,n))return;let s=Pi(r),o=setTimeout(()=>{t("SIGKILL")},s);o.unref&&o.unref()},$i=(t,{forceKillAfterTimeout:e},r)=>ki(t)&&e!==!1&&r,ki=t=>t===Gn.default.constants.signals.SIGTERM||typeof t=="string"&&t.toUpperCase()==="SIGTERM",Pi=({forceKillAfterTimeout:t=!0})=>{if(t===!0)return vi;if(!Number.isFinite(t)||t<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${t}\` (${typeof t})`);return t},Hn=(t,e)=>{t.kill()&&(e.isCanceled=!0)},Ci=(t,e,r)=>{t.kill(e),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:e}))},jn=(t,{timeout:e,killSignal:r="SIGTERM"},n)=>{if(e===0||e===void 0)return n;let s,o=new Promise((c,u)=>{s=setTimeout(()=>{Ci(t,r,u)},e)}),i=n.finally(()=>{clearTimeout(s)});return Promise.race([o,i])},Kn=({timeout:t})=>{if(t!==void 0&&(!Number.isFinite(t)||t<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${t}\` (${typeof t})`)},Yn=async(t,{cleanup:e,detached:r},n)=>{if(!e||r)return n;let s=(0,zn.default)(()=>{t.kill()});return n.finally(()=>{s()})};function Zn(t){return t!==null&&typeof t=="object"&&typeof t.pipe=="function"}var ar=W(Xn(),1),ts=W(es(),1),rs=(t,e)=>{e!==void 0&&(Zn(e)?e.pipe(t.stdin):t.stdin.end(e))},ns=(t,{all:e})=>{if(!e||!t.stdout&&!t.stderr)return;let r=(0,ts.default)();return t.stdout&&r.add(t.stdout),t.stderr&&r.add(t.stderr),r},or=async(t,e)=>{if(!(!t||e===void 0)){t.destroy();try{return await e}catch(r){return r.bufferedData}}},ir=(t,{encoding:e,buffer:r,maxBuffer:n})=>{if(!(!t||!r))return e?(0,ar.default)(t,{encoding:e,maxBuffer:n}):ar.default.buffer(t,{maxBuffer:n})},ss=async({stdout:t,stderr:e,all:r},{encoding:n,buffer:s,maxBuffer:o},i)=>{let c=ir(t,{encoding:n,buffer:s,maxBuffer:o}),u=ir(e,{encoding:n,buffer:s,maxBuffer:o}),p=ir(r,{encoding:n,buffer:s,maxBuffer:o*2});try{return await Promise.all([i,c,u,p])}catch(E){return Promise.all([{error:E,signal:E.signal,timedOut:E.timedOut},or(t,c),or(e,u),or(r,p)])}};var Fi=(async()=>{})().constructor.prototype,Ui=["then","catch","finally"].map(t=>[t,Reflect.getOwnPropertyDescriptor(Fi,t)]),cr=(t,e)=>{for(let[r,n]of Ui){let s=typeof e=="function"?(...o)=>Reflect.apply(n.value,e(),o):n.value.bind(e);Reflect.defineProperty(t,r,{...n,value:s})}return t},os=t=>new Promise((e,r)=>{t.on("exit",(n,s)=>{e({exitCode:n,signal:s})}),t.on("error",n=>{r(n)}),t.stdin&&t.stdin.on("error",n=>{r(n)})});var is=(t,e=[])=>Array.isArray(e)?[t,...e]:[t],Vi=/^[\w.-]+$/,Mi=/"/g,Bi=t=>typeof t!="string"||Vi.test(t)?t:`"${t.replace(Mi,'\\"')}"`,as=(t,e)=>is(t,e).join(" "),cs=(t,e)=>is(t,e).map(r=>Bi(r)).join(" ");var Gi=1e3*1e3*100,zi=({env:t,extendEnv:e,preferLocal:r,localDir:n,execPath:s})=>{let o=e?{...Qe.default.env,...t}:t;return r?Tn({env:o,cwd:n,execPath:s}):o},Wi=(t,e,r={})=>{let n=ds.default._parse(t,e,r);return t=n.command,e=n.args,r=n.options,r={maxBuffer:Gi,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:r.cwd||Qe.default.cwd(),execPath:Qe.default.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...r},r.env=zi(r),r.stdio=Nn(r),Qe.default.platform==="win32"&&us.default.basename(t,".exe")==="cmd"&&e.unshift("/q"),{file:t,args:e,options:r,parsed:n}},lr=(t,e,r)=>typeof e!="string"&&!ls.Buffer.isBuffer(e)?r===void 0?void 0:"":t.stripFinalNewline?Xt(e):e;function fs(t,e,r){let n=Wi(t,e,r),s=as(t,e),o=cs(t,e);Kn(n.options);let i;try{i=ur.default.spawn(n.file,n.args,n.options)}catch(T){let P=new ur.default.ChildProcess,x=Promise.reject(tr({error:T,stdout:"",stderr:"",all:"",command:s,escapedCommand:o,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return cr(P,x)}let c=os(i),u=jn(i,n.options,c),p=Yn(i,n.options,u),E={isCanceled:!1};i.kill=Wn.bind(null,i.kill.bind(i)),i.cancel=Hn.bind(null,i,E);let C=kn(async()=>{let[{error:T,exitCode:P,signal:x,timedOut:b},h,y,$]=await ss(i,n.options,p),L=lr(n.options,h),A=lr(n.options,y),O=lr(n.options,$);if(T||P!==0||x!==null){let ae=tr({error:T,exitCode:P,signal:x,stdout:L,stderr:A,all:O,command:s,escapedCommand:o,parsed:n,timedOut:b,isCanceled:E.isCanceled||(n.options.signal?n.options.signal.aborted:!1),killed:i.killed});if(!n.options.reject)return ae;throw ae}return{command:s,escapedCommand:o,exitCode:0,stdout:L,stderr:A,all:O,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return rs(i,n.options.input),i.all=ns(i,n.options),cr(i,C)}var J=require("fs");var Ue=require("@raycast/api");var ps="https://bitwarden.com";var _={PASSWORD_OPTIONS:"bw-generate-password-options",PASSWORD_ONE_TIME_WARNING:"bw-generate-password-warning-accepted",SESSION_TOKEN:"sessionToken",REPROMPT_HASH:"sessionRepromptHash",SERVER_URL:"cliServer",LAST_ACTIVITY_TIME:"lastActivityTime",VAULT_LOCK_REASON:"vaultLockReason",VAULT_FAVORITE_ORDER:"vaultFavoriteOrder",VAULT_LAST_STATUS:"lastVaultStatus"},Ve={TIMEOUT:"Vault timed out due to inactivity",MANUAL:"Manually locked by the user",SYSTEM_LOCK:"Screen was locked",SYSTEM_SLEEP:"System went to sleep",CLI_UPDATED:"Bitwarden has been updated. Please login again."};var fe={IV:"iv",VAULT:"vault",CURRENT_FOLDER_ID:"currentFolderId",SEND_TYPE_FILTER:"sendTypeFilter",CLI_VERSION:"cliVersion"},Gc={1:Ue.Icon.Globe,3:Ue.Icon.CreditCard,4:Ue.Icon.Person,2:Ue.Icon.Document,5:Ue.Icon.Key};var Hi=require("@raycast/api"),gs=require("crypto");var hs="foobarbazzybaz";function ys(t){return Object.entries(t).flatMap(([e,r])=>r?[`--${e}`,r]:[])}function dr(t){return new Promise((e,r)=>{(0,gs.pbkdf2)(t,hs,1e5,64,"sha512",(n,s)=>{if(n!=null){r(n);return}e(s.toString("hex"))})})}var fr=require("@raycast/api");var ji={IMMEDIATELY:"0",ONE_MINUTE:"60000",FIVE_MINUTES:"300000",FIFTEEN_MINUTES:"900000",THIRTY_MINUTES:"1800000",ONE_HOUR:"3600000",FOUR_HOURS:"14400000",EIGHT_HOURS:"28800000",ONE_DAY:"86400000",NEVER:"-1",SYSTEM_LOCK:"-2",SYSTEM_SLEEP:"-3"},K=Object.entries(ji).reduce((t,[e,r])=>(t[e]=parseInt(r),t),{});var ws={[K.IMMEDIATELY]:"Immediately",[K.ONE_MINUTE]:"1 Minute",[K.FIVE_MINUTES]:"5 Minutes",[K.FIFTEEN_MINUTES]:"15 Minutes",[K.THIRTY_MINUTES]:"30 Minutes",[K.ONE_HOUR]:"1 Hour",[K.FOUR_HOURS]:"4 Hours",[K.EIGHT_HOURS]:"8 Hours",[K.ONE_DAY]:"1 Day"};var el={1:"Login",3:"Card",4:"Identity",2:"Secure Note",5:"SSH Key"};function Tt(){let{serverUrl:t}=(0,fr.getPreferenceValues)();return!t||t==="bitwarden.com"||t==="https://bitwarden.com"?void 0:t}function bs(t){return ws[t]}var ce=class extends Error{constructor(e,r){super(e),this.stack=r}},et=class extends ce{constructor(e,r){super(e,r)}};var me=class extends et{constructor(e,r){super(e??"Bitwarden CLI not found",r),this.name="InstalledCLINotFoundError",this.stack=r}};var $t=class extends et{constructor(e,r){super(e??"Vault is locked",r),this.name="VaultIsLockedError"}},tt=class extends ce{constructor(e,r){super(e??"Not logged in",r),this.name="NotLoggedInError"}},ve=class extends et{constructor(e,r){super(e??"Failed do download Bitwarden CLI",r),this.name="EnsureCliBinError"}},kt=class extends ce{constructor(e,r){super(e??"Premium status is required to use this feature",r),this.name="PremiumFeatureError"}},rt=class extends ce{constructor(e,r){super(e??"This Send has a is protected by a password",r),this.name="SendNeedsPasswordError"}},nt=class extends ce{constructor(e,r){super(e??"The password you entered is invalid",r),this.name="SendInvalidPasswordError"}};function Te(t,e){try{return t()}catch{return e}}var Pt=t=>{if(t){if(typeof t=="string")return t;if(t instanceof Error){let{message:e,name:r}=t;return t.stack?t.stack:`${r}: ${e}`}return String(t)}};var ke=require("path"),ze=require("fs/promises");var le=require("fs"),At=require("fs/promises"),$s=require("path"),ks=W(Ts());function Rt(t){return new Promise((e,r)=>{let n=setInterval(()=>{if(!(0,le.existsSync)(t))return;(0,le.statSync)(t).isFile()&&(clearInterval(n),e())},300);setTimeout(()=>{clearInterval(n),r(new Error(`File ${t} not found.`))},5e3)})}async function Ps(t,e){let r=new ks.default.async({file:t});(0,le.existsSync)(e)||(0,le.mkdirSync)(e,{recursive:!0}),await r.extract(null,e),await r.close()}async function Cs(t,e){let r=!1;try{let n=await(0,At.readdir)(e);for await(let s of n)s.startsWith(t)&&await Te(async()=>{await(0,At.unlink)((0,$s.join)(e,s)),r=!0})}catch{return!1}return r}function Ls(...t){for(let e of t)Te(()=>(0,le.unlinkSync)(e))}var Ge=require("fs"),Ns=W(require("http")),Ds=W(require("https"));var Er=require("@raycast/api");var As=require("@raycast/api"),Yi={logs:new Map,set:(t,e)=>{Be.logs.set(new Date,{message:t,error:e})},clear:()=>Be.logs.clear(),toString:()=>{let t="";return Be.logs.forEach((e,r)=>{t.length>0&&(t+=`

`),t+=`[${r.toISOString()}] ${e.message}`,e.error&&(t+=`: ${Pt(e.error)}`)}),t}},Be=Object.freeze(Yi),w=(t,e,r)=>{let{captureToRaycast:n=!1}=r??{},s=Array.isArray(t)?t.filter(Boolean).join(" "):t||"Captured exception";Be.set(s,e),Er.environment.isDevelopment?console.error(s,e):n&&(0,As.captureException)(e)},Rs=(...t)=>{Er.environment.isDevelopment&&console.debug(...t)};var Os=require("fs"),_s=require("crypto");function Sr(t){try{return(0,_s.createHash)("sha256").update((0,Os.readFileSync)(t)).digest("hex")}catch{return null}}function xr(t,e,r){let{onProgress:n,sha256:s}=r??{};return new Promise((o,i)=>{let c=new URL(t),u=c.protocol==="https:"?Ds.default:Ns.default,p=0,E=u.get(c.href,g=>{if(g.statusCode&&g.statusCode>=300&&g.statusCode<400){E.destroy(),g.destroy();let h=g.headers.location;if(!h){i(new Error("Redirect response without location header"));return}if(++p>=10){i(new Error("Too many redirects"));return}xr(h,e,r).then(o).catch(i);return}if(g.statusCode!==200){i(new Error(`Response status ${g.statusCode}: ${g.statusMessage}`));return}let C=parseInt(g.headers["content-length"]||"0",10);if(C===0){i(new Error("Invalid file size"));return}let T=(0,Ge.createWriteStream)(e,{autoClose:!0}),P=0,x=()=>{E.destroy(),g.destroy(),T.close()},b=h=>{x(),i(h)};g.on("data",h=>{P+=h.length;let y=Math.floor(P/C*100);n?.(y)}),T.on("finish",async()=>{try{await Rt(e),s&&await Zi(e,s),o()}catch(h){i(h)}finally{x()}}),T.on("error",h=>{w(`File stream error while downloading ${t}`,h),(0,Ge.unlink)(e,()=>b(h))}),g.on("error",h=>{w(`Response error while downloading ${t}`,h),(0,Ge.unlink)(e,()=>b(h))}),E.on("error",h=>{w(`Request error while downloading ${t}`,h),(0,Ge.unlink)(e,()=>b(h))}),g.pipe(T)})})}function Zi(t,e){return new Promise((r,n)=>{let s=Sr(t);if(!s)return n(new Error(`Could not generate hash for file ${t}.`));if(s===e)return r();let o=setInterval(()=>{Sr(t)===e&&(clearInterval(o),r())},1e3);setTimeout(()=>{clearInterval(o),n(new Error(`Hash did not match, expected ${e.substring(0,7)}, got ${s.substring(0,7)}.`))},5e3)})}function Fs(t,e){return{...t,...e,file:e.file?{...t.file,...e.file}:t.file,text:e.text?{...t.text,...e.text}:t.text}}var Us=require("@raycast/api"),ue=new Us.Cache({namespace:"bw-cache"});var G=process.platform==="darwin"?"macos":"windows";var{supportPath:$e}=F.environment,qi="4",Ot=(()=>{let t=(0,ke.join)($e,`bw-bin-download-error-${qi}.log`);return{logError:e=>Te(()=>(0,J.writeFileSync)(t,e?.message??"Unexpected error")),clearError:()=>Te(()=>(0,J.unlinkSync)(t)),hasError:()=>Te(()=>(0,J.existsSync)(t),!1)}})(),q={version:"2025.2.0",get sha256(){return G==="windows"?"33a131017ac9c99d721e430a86e929383314d3f91c9f2fbf413d872565654c18":"fade51012a46011c016a2e5aee2f2e534c1ed078e49d1178a69e2889d2812a96"},downloadPage:"https://github.com/bitwarden/clients/releases",path:{get downloadedBin(){return(0,ke.join)($e,q.binFilenameVersioned)},get installedBin(){return G==="windows"?"C:\\ProgramData\\chocolatey\\bin\\bw.exe":process.arch==="arm64"?"/opt/homebrew/bin/bw":"/usr/local/bin/bw"},get bin(){return Ot.hasError()?this.installedBin:this.downloadedBin}},get binFilename(){return G==="windows"?"bw.exe":"bw"},get binFilenameVersioned(){let t=`bw-${this.version}`;return G==="windows"?`${t}.exe`:`${t}`},get downloadUrl(){let t="";return G==="macos"&&(t=process.arch==="arm64"?"-arm64":""),`${this.downloadPage}/download/cli-v${this.version}/bw-${G}${t}-${this.version}.zip`}},_t=class{constructor(e){this.actionListeners=new Map;this.preferences=(0,F.getPreferenceValues)();this.wasCliUpdated=!1;this.showToast=async e=>{if(this.toastInstance){let r={message:this.toastInstance.message,title:this.toastInstance.title,primaryAction:this.toastInstance.primaryAction,secondaryAction:this.toastInstance.secondaryAction};return e.style&&(this.toastInstance.style=e.style),this.toastInstance.message=e.message,this.toastInstance.title=e.title,this.toastInstance.primaryAction=e.primaryAction,this.toastInstance.secondaryAction=e.secondaryAction,await this.toastInstance.show(),Object.assign(this.toastInstance,{restore:async()=>{await this.showToast(r)}})}else{let r=await(0,F.showToast)(e);return Object.assign(r,{restore:()=>r.hide()})}};let{cliPath:r,clientId:n,clientSecret:s,serverCertsPath:o}=this.preferences,i=Tt();this.toastInstance=e,this.cliPath=r||q.path.bin,this.env={BITWARDENCLI_APPDATA_DIR:$e,BW_CLIENTSECRET:s.trim(),BW_CLIENTID:n.trim(),PATH:(0,ke.dirname)(process.execPath),...i&&o?{NODE_EXTRA_CA_CERTS:o}:{}},this.initPromise=(async()=>{await this.ensureCliBinary(),this.retrieveAndCacheCliVersion(),await this.checkServerUrl(i)})()}async ensureCliBinary(){if(this.checkCliBinIsReady(this.cliPath))return;if(this.cliPath===this.preferences.cliPath||this.cliPath===q.path.installedBin)throw new me(`Bitwarden CLI not found at ${this.cliPath}`);Ot.hasError()&&Ot.clearError();let e=await Cs("bw-",$e),r=await this.showToast({title:`${e?"Updating":"Initializing"} Bitwarden CLI`,style:F.Toast.Style.Animated,primaryAction:{title:"Open Download Page",onAction:()=>(0,F.open)(q.downloadPage)}}),s=(0,ke.join)($e,"bw.zip");try{try{r.message="Downloading...",await xr(q.downloadUrl,s,{onProgress:o=>r.message=`Downloading ${o}%`,sha256:q.sha256})}catch(o){throw r.title="Failed to download Bitwarden CLI",o}try{r.message="Extracting...",await Ps(s,$e);let o=(0,ke.join)($e,q.binFilename);await(0,ze.rename)(o,this.cliPath).catch(()=>null),await Rt(this.cliPath),await(0,ze.chmod)(this.cliPath,"755"),await(0,ze.rm)(s,{force:!0}),ue.set(fe.CLI_VERSION,q.version),this.wasCliUpdated=!0}catch(o){throw r.title="Failed to extract Bitwarden CLI",o}await r.hide()}catch(o){throw r.message=o instanceof ve?o.message:"Please try again",r.style=F.Toast.Style.Failure,Ls(s,this.cliPath),F.environment.isDevelopment||Ot.logError(o),o instanceof Error?new ve(o.message,o.stack):o}finally{await r.restore()}}async retrieveAndCacheCliVersion(){try{let{error:e,result:r}=await this.getVersion();e||ue.set(fe.CLI_VERSION,r)}catch(e){w("Failed to retrieve and cache cli version",e,{captureToRaycast:!0})}}checkCliBinIsReady(e){try{return(0,J.existsSync)(this.cliPath)?((0,J.accessSync)(e,J.constants.X_OK),!0):!1}catch{return(0,J.chmodSync)(e,"755"),!0}}setSessionToken(e){this.env={...this.env,BW_SESSION:e}}clearSessionToken(){delete this.env.BW_SESSION}withSession(e){return this.tempSessionToken=e,this}async initialize(){return await this.initPromise,this}async checkServerUrl(e){let r=await F.LocalStorage.getItem(_.SERVER_URL);if(!e||r===e)return;let n=await this.showToast({style:F.Toast.Style.Animated,title:"Switching server...",message:"Bitwarden server preference changed"});try{try{await this.logout()}catch{}await this.exec(["config","server",e||ps],{resetVaultTimeout:!1}),await F.LocalStorage.setItem(_.SERVER_URL,e),n.style=F.Toast.Style.Success,n.title="Success",n.message="Bitwarden server changed"}catch(s){n.style=F.Toast.Style.Failure,n.title="Failed to switch server",s instanceof Error?n.message=s.message:n.message="Unknown error occurred"}finally{await n.restore()}}async exec(e,r){let{abortController:n,input:s="",resetVaultTimeout:o}=r??{},i=this.env;this.tempSessionToken&&(i={...i,BW_SESSION:this.tempSessionToken},this.tempSessionToken=void 0);let c=await fs(this.cliPath,e,{input:s,env:i,signal:n?.signal});if(this.isPromptWaitingForMasterPassword(c))throw await this.lock(),new $t;return o&&await F.LocalStorage.setItem(_.LAST_ACTIVITY_TIME,new Date().toISOString()),c}async getVersion(){try{let{stdout:e}=await this.exec(["--version"],{resetVaultTimeout:!1});return{result:e}}catch(e){w("Failed to get cli version",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async login(){try{return await this.exec(["login","--apikey"],{resetVaultTimeout:!0}),await this.saveLastVaultStatus("login","unlocked"),await this.callActionListeners("login"),{result:void 0}}catch(e){w("Failed to login",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async logout(e){let{reason:r,immediate:n=!1}=e??{};try{return n&&await this.handlePostLogout(r),await this.exec(["logout"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("logout","unauthenticated"),n||await this.handlePostLogout(r),{result:void 0}}catch(s){w("Failed to logout",s);let{error:o}=await this.handleCommonErrors(s);if(!o)throw s;return{error:o}}}async lock(e){let{reason:r,checkVaultStatus:n=!1,immediate:s=!1}=e??{};try{if(s&&await this.callActionListeners("lock",r),n){let{error:o,result:i}=await this.status();if(o)throw o;if(i.status==="unauthenticated")return{error:new tt("Not logged in")}}return await this.exec(["lock"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("lock","locked"),s||await this.callActionListeners("lock",r),{result:void 0}}catch(o){w("Failed to lock vault",o);let{error:i}=await this.handleCommonErrors(o);if(!i)throw o;return{error:i}}}async unlock(e){try{let{stdout:r}=await this.exec(["unlock",e,"--raw"],{resetVaultTimeout:!0});return this.setSessionToken(r),await this.saveLastVaultStatus("unlock","unlocked"),await this.callActionListeners("unlock",e,r),{result:r}}catch(r){w("Failed to unlock vault",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async sync(){try{return await this.exec(["sync"],{resetVaultTimeout:!0}),{result:void 0}}catch(e){w("Failed to sync vault",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async getItem(e){try{let{stdout:r}=await this.exec(["get","item",e],{resetVaultTimeout:!0});return{result:JSON.parse(r)}}catch(r){w("Failed to get item",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async listItems(){try{let{stdout:e}=await this.exec(["list","items"],{resetVaultTimeout:!0});return{result:JSON.parse(e).filter(n=>!!n.name)}}catch(e){w("Failed to list items",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createLoginItem(e){try{let{error:r,result:n}=await this.getTemplate("item");if(r)throw r;let{error:s,result:o}=await this.getTemplate("item.login");if(s)throw s;n.name=e.name,n.type=1,n.folderId=e.folderId||null,n.login=o,n.notes=null,o.username=e.username||null,o.password=e.password,o.totp=null,o.fido2Credentials=void 0,e.uri&&(o.uris=[{match:null,uri:e.uri}]);let{result:i,error:c}=await this.encode(JSON.stringify(n));if(c)throw c;let{stdout:u}=await this.exec(["create","item",i],{resetVaultTimeout:!0});return{result:JSON.parse(u)}}catch(r){w("Failed to create login item",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async listFolders(){try{let{stdout:e}=await this.exec(["list","folders"],{resetVaultTimeout:!0});return{result:JSON.parse(e)}}catch(e){w("Failed to list folder",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createFolder(e){try{let{error:r,result:n}=await this.getTemplate("folder");if(r)throw r;n.name=e;let{result:s,error:o}=await this.encode(JSON.stringify(n));if(o)throw o;return await this.exec(["create","folder",s],{resetVaultTimeout:!0}),{result:void 0}}catch(r){w("Failed to create folder",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async getTotp(e){try{let{stdout:r}=await this.exec(["get","totp",e],{resetVaultTimeout:!0});return{result:r}}catch(r){w("Failed to get TOTP",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async status(){try{let{stdout:e}=await this.exec(["status"],{resetVaultTimeout:!1});return{result:JSON.parse(e)}}catch(e){w("Failed to get status",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async checkLockStatus(){try{return await this.exec(["unlock","--check"],{resetVaultTimeout:!1}),await this.saveLastVaultStatus("checkLockStatus","unlocked"),"unlocked"}catch(e){return w("Failed to check lock status",e),e.stderr==="Vault is locked."?(await this.saveLastVaultStatus("checkLockStatus","locked"),"locked"):(await this.saveLastVaultStatus("checkLockStatus","unauthenticated"),"unauthenticated")}}async getTemplate(e){try{let{stdout:r}=await this.exec(["get","template",e],{resetVaultTimeout:!0});return{result:JSON.parse(r)}}catch(r){w("Failed to get template",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async encode(e){try{let{stdout:r}=await this.exec(["encode"],{input:e,resetVaultTimeout:!1});return{result:r}}catch(r){w("Failed to encode",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async generatePassword(e,r){let n=e?ys(e):[],{stdout:s}=await this.exec(["generate",...n],{abortController:r,resetVaultTimeout:!1});return s}async listSends(){try{let{stdout:e}=await this.exec(["send","list"],{resetVaultTimeout:!0});return{result:JSON.parse(e)}}catch(e){w("Failed to list sends",e);let{error:r}=await this.handleCommonErrors(e);if(!r)throw e;return{error:r}}}async createSend(e){try{let{error:r,result:n}=await this.getTemplate(e.type===0?"send.text":"send.file");if(r)throw r;let s=Fs(n,e),{result:o,error:i}=await this.encode(JSON.stringify(s));if(i)throw i;let{stdout:c}=await this.exec(["send","create",o],{resetVaultTimeout:!0});return{result:JSON.parse(c)}}catch(r){w("Failed to create send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async editSend(e){try{let{result:r,error:n}=await this.encode(JSON.stringify(e));if(n)throw n;let{stdout:s}=await this.exec(["send","edit",r],{resetVaultTimeout:!0});return{result:JSON.parse(s)}}catch(r){w("Failed to delete send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async deleteSend(e){try{return await this.exec(["send","delete",e],{resetVaultTimeout:!0}),{result:void 0}}catch(r){w("Failed to delete send",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async removeSendPassword(e){try{return await this.exec(["send","remove-password",e],{resetVaultTimeout:!0}),{result:void 0}}catch(r){w("Failed to remove send password",r);let{error:n}=await this.handleCommonErrors(r);if(!n)throw r;return{error:n}}}async receiveSendInfo(e,r){try{let{stdout:n,stderr:s}=await this.exec(["send","receive",e,"--obj"],{resetVaultTimeout:!0,input:r?.password});return!n&&/Invalid password/i.test(s)?{error:new nt}:!n&&/Send password/i.test(s)?{error:new rt}:{result:JSON.parse(n)}}catch(n){let s=n.stderr;if(/Invalid password/gi.test(s))return{error:new nt};if(/Send password/gi.test(s))return{error:new rt};w("Failed to receive send obj",n);let{error:o}=await this.handleCommonErrors(n);if(!o)throw n;return{error:o}}}async receiveSend(e,r){try{let{savePath:n,password:s}=r??{},o=["send","receive",e];n&&o.push("--output",n);let{stdout:i}=await this.exec(o,{resetVaultTimeout:!0,input:s});return{result:i}}catch(n){w("Failed to receive send",n);let{error:s}=await this.handleCommonErrors(n);if(!s)throw n;return{error:s}}}async saveLastVaultStatus(e,r){await F.LocalStorage.setItem(_.VAULT_LAST_STATUS,r)}async getLastSavedVaultStatus(){let e=await F.LocalStorage.getItem(_.VAULT_LAST_STATUS);return e||(await this.status()).result?.status}isPromptWaitingForMasterPassword(e){return!!(e.stderr&&e.stderr.includes("Master password"))}async handlePostLogout(e){this.clearSessionToken(),await this.callActionListeners("logout",e)}async handleCommonErrors(e){let r=e.stderr;return r?/not logged in/i.test(r)?(await this.handlePostLogout(),{error:new tt("Not logged in")}):/Premium status/i.test(r)?{error:new kt}:{}:{}}setActionListener(e,r){let n=this.actionListeners.get(e);return n&&n.size>0?n.add(r):this.actionListeners.set(e,new Set([r])),this}removeActionListener(e,r){let n=this.actionListeners.get(e);return n&&n.size>0&&n.delete(r),this}async callActionListeners(e,...r){let n=this.actionListeners.get(e);if(n&&n.size>0)for(let s of n)try{await s?.(...r)}catch(o){w(`Error calling bitwarden action listener for ${e}`,o)}}};var Vs=require("@raycast/api"),Bs=require("react/jsx-runtime"),Ms=()=>(0,Bs.jsx)(Vs.Form,{isLoading:!0});var re=require("@raycast/api");var fa=require("@raycast/api");var Ir=require("react"),jl=(0,Ir.createContext)(null);var kr=require("@raycast/api");var vr=require("@raycast/api"),Gs=require("react/jsx-runtime");var We=require("@raycast/api"),Ce=require("react");var I=require("@raycast/api"),st=require("react");function zs(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function Ws(t,e){try{let r=t,n;return r?.stderr?n=r.stderr:t instanceof Error?n=`${t.name}: ${t.message}`:zs(t)?n=JSON.stringify(t):n=`${t}`,n?e?.omitSensitiveValue?Ji(n,e.omitSensitiveValue):n:""}catch{return""}}function Ji(t,e){return t.replace(new RegExp(e,"i"),"[REDACTED]")}var se=require("@raycast/api"),Nt=require("react");function Xi(){let t=oe(),[e,r]=(0,Nt.useState)(null);(0,Nt.useEffect)(()=>{t.status().then(({error:i,result:c})=>{i||r(c)}).catch(()=>{})},[]);let n=!!Tt(),s="...",o="...";if(e){let{status:i,userEmail:c,serverUrl:u}=e;s=i=="unauthenticated"?"\u274C Logged out":`\u{1F512} Locked (${c})`,u?o=u||"":(!u&&n||u&&!n)&&(0,se.confirmAlert)({icon:se.Icon.ExclamationMark,title:"Restart Required",message:"Bitwarden server URL preference has been changed since the extension was opened.",primaryAction:{title:"Close Extension"},dismissAction:{title:"Close Raycast",style:se.Alert.ActionStyle.Cancel}}).then(p=>{p?(0,se.popToRoot)():(0,se.closeMainWindow)()})}return{userMessage:s,serverMessage:o,shouldShowServer:n}}var Hs=Xi;var Ut=require("@raycast/api");var v=W(require("react")),R=require("@raycast/api");var js=Object.prototype.hasOwnProperty;function Dt(t,e){var r,n;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((n=t.length)===e.length)for(;n--&&Dt(t[n],e[n]););return n===-1}if(!r||typeof t=="object"){n=0;for(r in t)if(js.call(t,r)&&++n&&!js.call(e,r)||!(r in e)||!Dt(t[r],e[r]))return!1;return Object.keys(e).length===n}}return t!==t&&e!==e}var Pe=W(require("node:fs")),Ft=W(require("node:path"));var Ys=require("react/jsx-runtime");function Qi(t){let e=(0,v.useRef)(t),r=(0,v.useRef)(0);return Dt(t,e.current)||(e.current=t,r.current+=1),(0,v.useMemo)(()=>e.current,[r.current])}function ie(t){let e=(0,v.useRef)(t);return e.current=t,e}function ea(t,e){let r=t instanceof Error?t.message:String(t);return(0,R.showToast)({style:R.Toast.Style.Failure,title:e?.title??"Something went wrong",message:e?.message??r,primaryAction:e?.primaryAction??Ks(t),secondaryAction:e?.primaryAction?Ks(t):void 0})}var Ks=t=>{let e=!0,r="[Extension Name]...",n="";try{let i=JSON.parse((0,Pe.readFileSync)((0,Ft.join)(R.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,n=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(e=!1)}catch{}let s=R.environment.isDevelopment||e,o=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:s?"Copy Logs":"Report Error",onAction(i){i.hide(),s?R.Clipboard.copy(o):(0,R.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${o}
\`\`\`
`)}`)}}};function Zs(t,e,r){let n=(0,v.useRef)(0),[s,o]=(0,v.useState)({isLoading:!0}),i=ie(t),c=ie(r?.abortable),u=ie(e||[]),p=ie(r?.onError),E=ie(r?.onData),g=ie(r?.onWillExecute),C=ie(r?.failureToastOptions),T=ie(s.data),P=(0,v.useRef)(null),x=(0,v.useRef)({page:0}),b=(0,v.useRef)(!1),h=(0,v.useRef)(!0),y=(0,v.useRef)(50),$=(0,v.useCallback)(()=>(c.current&&(c.current.current?.abort(),c.current.current=new AbortController),++n.current),[c]),L=(0,v.useCallback)((...X)=>{let j=$();g.current?.(X),o(d=>({...d,isLoading:!0}));let a=ta(i.current)(...X);function f(d){return d.name=="AbortError"||j===n.current&&(p.current?p.current(d):R.environment.launchType!==R.LaunchType.Background&&ea(d,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(m){m.hide(),P.current?.(...u.current||[])}},...C.current}),o({error:d,isLoading:!1})),d}return typeof a=="function"?(b.current=!0,a(x.current).then(({data:d,hasMore:m,cursor:k})=>(j===n.current&&(x.current&&(x.current.cursor=k,x.current.lastItem=d?.[d.length-1]),E.current&&E.current(d,x.current),m&&(y.current=d.length),h.current=m,o(S=>x.current.page===0?{data:d,isLoading:!1}:{data:(S.data||[])?.concat(d),isLoading:!1})),d),d=>(h.current=!1,f(d)))):(b.current=!1,a.then(d=>(j===n.current&&(E.current&&E.current(d),o({data:d,isLoading:!1})),d),f))},[E,p,u,i,o,P,g,x,C,$]);P.current=L;let A=(0,v.useCallback)(()=>{x.current={page:0};let X=u.current||[];return L(...X)},[L,u]),O=(0,v.useCallback)(async(X,j)=>{let a;try{if(j?.optimisticUpdate){$(),typeof j?.rollbackOnError!="function"&&j?.rollbackOnError!==!1&&(a=structuredClone(T.current?.value));let f=j.optimisticUpdate;o(d=>({...d,data:f(d.data)}))}return await X}catch(f){if(typeof j?.rollbackOnError=="function"){let d=j.rollbackOnError;o(m=>({...m,data:d(m.data)}))}else j?.optimisticUpdate&&j?.rollbackOnError!==!1&&o(d=>({...d,data:a}));throw f}finally{j?.shouldRevalidateAfter!==!1&&(R.environment.launchType===R.LaunchType.Background||R.environment.commandMode==="menu-bar"?await A():A())}},[A,T,o,$]),ae=(0,v.useCallback)(()=>{x.current.page+=1;let X=u.current||[];L(...X)},[x,u,L]);(0,v.useEffect)(()=>{x.current={page:0},r?.execute!==!1?L(...e||[]):$()},[Qi([e,r?.execute,L]),c,x]),(0,v.useEffect)(()=>()=>{$()},[$]);let Ae=r?.execute!==!1?s.isLoading:!1,Ye={...s,isLoading:Ae},pt=b.current?{pageSize:y.current,hasMore:h.current,onLoadMore:ae}:void 0;return{...Ye,revalidate:A,mutate:O,pagination:pt}}function ta(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}var qs=(function(t){return t.Required="required",t})({});function Tr(t,e){if(t){if(typeof t=="function")return t(e);if(t==="required"){let r=typeof e<"u"&&e!==null;if(r)switch(typeof e){case"string":r=e.length>0;break;case"object":Array.isArray(e)?r=e.length>0:e instanceof Date&&(r=e.getTime()>0);break;default:break}if(!r)return"The item is required"}}}function Js(t){let{onSubmit:e,validation:r,initialValues:n={}}=t,[s,o]=(0,v.useState)(n),[i,c]=(0,v.useState)({}),u=(0,v.useRef)({}),p=ie(r||{}),E=ie(e),g=(0,v.useCallback)(h=>{u.current[h]?.focus()},[u]),C=(0,v.useCallback)(async h=>{let y=!1;for(let[L,A]of Object.entries(p.current)){let O=Tr(A,h[L]);O&&(y||(y={},g(L)),y[L]=O)}if(y)return c(y),!1;let $=await E.current(h);return typeof $=="boolean"?$:!0},[p,E,g]),T=(0,v.useCallback)((h,y)=>{c($=>({...$,[h]:y}))},[c]),P=(0,v.useCallback)(function(h,y){o($=>({...$,[h]:typeof y=="function"?y($[h]):y}))},[o]),x=(0,v.useMemo)(()=>new Proxy({},{get(h,y){let $=p.current[y],L=s[y];return{onChange(A){i[y]&&(Tr($,A)||T(y,void 0)),P(y,A)},onBlur(A){let O=Tr($,A.target.value);O&&T(y,O)},error:i[y],id:y,value:typeof L>"u"?null:L,ref:A=>{u.current[y]=A}}}}),[i,p,T,s,u,P]),b=(0,v.useCallback)(h=>{c({}),Object.entries(u.current).forEach(([y,$])=>{h?.[y]||$?.reset()}),h&&o(h)},[o,c,u]);return{handleSubmit:C,setValidationError:T,setValue:P,values:s,itemProps:x,focus:g,reset:b}}function Xs(t,e){let{data:r,revalidate:n,isLoading:s}=Zs(()=>Ut.LocalStorage.getItem(t));return[r??e,{isLoading:s,set:async c=>{await Ut.LocalStorage.setItem(t,c),await n()},remove:async()=>{await Ut.LocalStorage.removeItem(t),await n()}}]}var V=require("react/jsx-runtime"),ra=({pendingAction:t=Promise.resolve()})=>{let e=oe(),{userMessage:r,serverMessage:n,shouldShowServer:s}=Hs(),[o,i]=(0,st.useState)(!1),[c,u]=(0,st.useState)(void 0),[p,E]=(0,st.useState)(!1),[g,C]=(0,st.useState)(""),[T,{remove:P}]=Xs(_.VAULT_LOCK_REASON);async function x(){if(g.length===0)return;let $=await(0,I.showToast)(I.Toast.Style.Animated,"Unlocking Vault...","Please wait");try{i(!0),u(void 0),await t;let{error:L,result:A}=await e.status();if(L)throw L;if(A.status==="unauthenticated")try{let{error:O}=await e.login();if(O)throw O}catch(O){let{displayableError:ae=`Please check your ${s?"Server URL, ":""}API Key and Secret.`,treatedError:Ae}=Qs(O,g);await(0,I.showToast)(I.Toast.Style.Failure,"Failed to log in",ae),u(Ae),w("Failed to log in",O);return}await e.unlock(g),await P(),await $.hide()}catch(L){let{displayableError:A="Please check your credentials",treatedError:O}=Qs(L,g);await(0,I.showToast)(I.Toast.Style.Failure,"Failed to unlock vault",A),u(O),w("Failed to unlock vault",L)}finally{i(!1)}}let b=async()=>{c&&(await I.Clipboard.copy(c),await(0,I.showToast)(I.Toast.Style.Success,"Error copied to clipboard"))},h=I.Form.PasswordField,y="password";return p&&(h=I.Form.TextField,y="plainPassword"),(0,V.jsxs)(I.Form,{actions:(0,V.jsxs)(I.ActionPanel,{children:[!o&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(I.Action.SubmitForm,{icon:I.Icon.LockUnlocked,title:"Unlock",onSubmit:x}),(0,V.jsx)(I.Action,{icon:p?I.Icon.EyeDisabled:I.Icon.Eye,title:p?"Hide Password":"Show Password",onAction:()=>E($=>!$),shortcut:{macOS:{key:"e",modifiers:["opt"]},windows:{key:"e",modifiers:["alt"]}}})]}),!!c&&(0,V.jsx)(I.Action,{onAction:b,title:"Copy Last Error",icon:I.Icon.Bug,style:I.Action.Style.Destructive}),(0,V.jsx)(ot,{})]}),children:[s&&(0,V.jsx)(I.Form.Description,{title:"Server URL",text:n}),(0,V.jsx)(I.Form.Description,{title:"Vault Status",text:r}),(0,V.jsx)(h,{id:y,title:"Master Password",value:g,onChange:C,ref:$=>$?.focus()}),(0,V.jsx)(I.Form.Description,{title:"",text:`Press ${G==="macos"?"\u2325":"Alt"}+E to ${p?"hide":"show"} password`}),!!T&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(I.Form.Description,{title:"\u2139\uFE0F",text:T}),(0,V.jsx)(na,{})]})]})};function na(){let t=(0,I.getPreferenceValues)().repromptIgnoreDuration,e=bs(t);return e?(0,V.jsx)(I.Form.Description,{title:"",text:`Timeout is set to ${e}, this can be configured in the extension settings`}):null}function Qs(t,e){let r=Ws(t,{omitSensitiveValue:e}),n;return/Invalid master password/i.test(r)?n="Invalid master password":/Invalid API Key/i.test(r)&&(n="Invalid Client ID or Secret"),{displayableError:n,treatedError:r}}var eo=ra;var to=require("@raycast/api"),no=require("react/jsx-runtime"),ro=()=>(0,no.jsx)(to.List,{searchBarPlaceholder:"Search vault",isLoading:!0});var so=require("react"),sa={token:void 0,passwordHash:void 0,isLoading:!0,isLocked:!1,isAuthenticated:!1},oo=()=>(0,so.useReducer)((t,e)=>{switch(e.type){case"loadState":{let{type:r,...n}=e;return{...t,...n}}case"lock":return{...t,token:void 0,passwordHash:void 0,isLoading:!1,isLocked:!0};case"unlock":return{...t,token:e.token,passwordHash:e.passwordHash,isLocked:!1,isAuthenticated:!0};case"logout":return{...t,token:void 0,passwordHash:void 0,isLocked:!0,isAuthenticated:!1,isLoading:!1};case"vaultTimeout":return{...t,isLocked:!0};case"finishLoadingSavedState":{if(!t.token||!t.passwordHash)throw new Error("Missing required fields: token, passwordHash");let r=!!t.token;return{...t,isLoading:!1,isLocked:!r,isAuthenticated:r}}case"failLoadingSavedState":return{...t,isLoading:!1,isLocked:!0};default:return t}},sa);var ee=require("@raycast/api");var io=require("child_process"),ao=require("util");var oa=(0,ao.promisify)(io.exec),it={getSavedSession:()=>Promise.all([ee.LocalStorage.getItem(_.SESSION_TOKEN),ee.LocalStorage.getItem(_.REPROMPT_HASH),ee.LocalStorage.getItem(_.LAST_ACTIVITY_TIME),ee.LocalStorage.getItem(_.VAULT_LAST_STATUS)]),clearSession:async()=>{await Promise.all([ee.LocalStorage.removeItem(_.SESSION_TOKEN),ee.LocalStorage.removeItem(_.REPROMPT_HASH)])},saveSession:async(t,e)=>{await Promise.all([ee.LocalStorage.setItem(_.SESSION_TOKEN,t),ee.LocalStorage.setItem(_.REPROMPT_HASH,e)])},logoutClearSession:async()=>{await Promise.all([ee.LocalStorage.removeItem(_.SESSION_TOKEN),ee.LocalStorage.removeItem(_.REPROMPT_HASH),ee.LocalStorage.removeItem(_.LAST_ACTIVITY_TIME)])}},co=t=>fo(t,e=>uo(e,"handleUnlockResult")),lo=t=>fo(t,e=>uo(e,"sleep 0"));function uo(t,e){return oa(`log show --style syslog --predicate "process == 'loginwindow'" --info --last ${t}h | grep "${e}" | tail -n 1`)}async function fo(t,e){let r=await mo(e);return r?new Date(r).getTime()>t.getTime():!0}var ia=2,aa=5;async function mo(t,e=1,r=0){try{if(r>aa){Rs("Max retry attempts reached to get last screen lock time");return}let{stdout:n,stderr:s}=await t(e),[o,i]=n?.split(" ")??[];if(s||!o||!i)return mo(t,e+ia,r+1);let c=new Date(`${o}T${i}`);return!c||c.toString()==="Invalid Date"?void 0:c}catch(n){w("Failed to get last screen lock time",n);return}}var Vt=require("react");function ca(t,e){let r=(0,Vt.useRef)(!1);(0,Vt.useEffect)(()=>{r.current||e!==void 0&&!e||(r.current=!0,t())},[e])}var we=ca;var Mt=require("react/jsx-runtime"),la=(0,Ce.createContext)(null);function $r(t){let{children:e,loadingFallback:r=(0,Mt.jsx)(ro,{}),unlock:n}=t,s=oe(),[o,i]=oo(),c=(0,Ce.useRef)(Promise.resolve());we(u,s);async function u(){try{s.setActionListener("lock",E).setActionListener("unlock",p).setActionListener("logout",g);let[b,h,y,$]=await it.getSavedSession();if(!b||!h)throw new be;if(i({type:"loadState",token:b,passwordHash:h}),s.setSessionToken(b),s.wasCliUpdated)throw new at(Ve.CLI_UPDATED);if($==="locked")throw new be;if($==="unauthenticated")throw new at;if(y){let L=new Date(y),A=+(0,We.getPreferenceValues)().repromptIgnoreDuration;if(G==="macos"&&A===K.SYSTEM_LOCK){if(await co(L))throw new be(Ve.SYSTEM_LOCK)}else if(G==="macos"&&A===K.SYSTEM_SLEEP){if(await lo(L))throw new be(Ve.SYSTEM_SLEEP)}else if(A!==K.NEVER){let O=Date.now()-L.getTime();if(A===K.IMMEDIATELY||O>=A)throw new be(Ve.TIMEOUT)}}i({type:"finishLoadingSavedState"})}catch(b){b instanceof be?c.current=s.lock({reason:b.message,immediate:!0,checkVaultStatus:!0}):b instanceof at?c.current=s.logout({reason:b.message,immediate:!0}):(c.current=s.lock({immediate:!0}),i({type:"failLoadingSavedState"}),w("Failed to bootstrap session state",b))}}async function p(b,h){let y=await dr(b);await it.saveSession(h,y),await We.LocalStorage.removeItem(_.VAULT_LOCK_REASON),i({type:"unlock",token:h,passwordHash:y})}async function E(b){await it.clearSession(),b&&await We.LocalStorage.setItem(_.VAULT_LOCK_REASON,b),i({type:"lock"})}async function g(b){await it.clearSession(),ue.clear(),b&&await We.LocalStorage.setItem(_.VAULT_LOCK_REASON,b),i({type:"logout"})}async function C(b){return await dr(b)===o.passwordHash}let T=(0,Ce.useMemo)(()=>({token:o.token,isLoading:o.isLoading,isAuthenticated:o.isAuthenticated,isLocked:o.isLocked,active:!o.isLoading&&o.isAuthenticated&&!o.isLocked,confirmMasterPassword:C}),[o,C]);if(o.isLoading)return r;let P=o.isLocked||!o.isAuthenticated,x=o.token?e:null;return(0,Mt.jsx)(la.Provider,{value:T,children:P&&n?(0,Mt.jsx)(eo,{pendingAction:c.current}):x})}var be=class extends Error{constructor(e){super(e)}},at=class extends Error{constructor(e){super(e)}};var da=require("react/jsx-runtime");var ma=require("react/jsx-runtime");var z=require("@raycast/api");var po=require("child_process"),ho=require("util");var Pr=require("fs"),go=require("path");var yo=require("react/jsx-runtime"),pa=(0,ho.promisify)(po.exec),{supportPath:ha}=z.environment,ga=()=>{let{clientId:t,clientSecret:e,fetchFavicons:r,generatePasswordQuickAction:n,repromptIgnoreDuration:s,serverCertsPath:o,serverUrl:i,shouldCacheVaultItems:c,transientCopyGeneratePassword:u,transientCopyGeneratePasswordQuick:p,transientCopySearch:E,windowActionOnCopy:g}=(0,z.getPreferenceValues)();return{has_clientId:!!t,has_clientSecret:!!e,fetchFavicons:r,generatePasswordQuickAction:n,repromptIgnoreDuration:s,has_serverCertsPath:!!o,has_serverUrl:!!i,shouldCacheVaultItems:c,transientCopyGeneratePassword:u,transientCopyGeneratePasswordQuick:p,transientCopySearch:E,windowActionOnCopy:g}},Z="N/A",Ee=async(t,e=!0)=>{try{let r=t;G==="windows"?r=`powershell -Command "${t}"`:r=`PATH="$PATH:${(0,go.dirname)(process.execPath)}" ${t}`;let{stdout:n}=await pa(r,{env:{BITWARDENCLI_APPDATA_DIR:ha}}),s=n.trim();return e?s.replace(/\n|\r/g,""):s}catch(r){return w(`Failed to execute command: ${t}`,r),Z}},ya=()=>{try{let t=(0,z.getPreferenceValues)().cliPath;return t?{type:"custom",path:t}:q.path.bin===q.path.downloadedBin?{type:"downloaded",path:q.path.downloadedBin}:{type:"installed",path:q.path.installedBin}}catch{return{type:Z,path:Z}}},wa=async()=>{try{let t="/opt/homebrew/bin/brew";if((0,Pr.existsSync)(t)||(t="/usr/local/bin/brew"),!(0,Pr.existsSync)(t))return{arch:Z,version:Z};let e=await Ee(`${t} config`,!1);if(e===Z)return{arch:Z,version:Z};let r=/HOMEBREW_PREFIX: (.+)/.exec(e)?.[1]||Z,n=/HOMEBREW_VERSION: (.+)/.exec(e)?.[1]||Z;return{arch:r!==Z?r.includes("/opt/homebrew")?"arm64":"x86_64":Z,version:n}}catch{return{arch:Z,version:Z}}};function ba(){let t=async()=>{let e=await(0,z.showToast)(z.Toast.Style.Animated,"Collecting data...");try{let r=ga(),n=ya(),[s,o,i,c]=await Promise.all([...G==="macos"?[Ee("uname -m"),Ee("sw_vers -productVersion"),Ee("sw_vers -buildVersion")]:[Ee("(Get-CimInstance Win32_OperatingSystem).OSArchitecture"),Ee("(Get-CimInstance Win32_OperatingSystem).Caption"),Ee("(Get-CimInstance Win32_OperatingSystem).Version")],Ee(`${n.path} --version`)]),u={raycast:{version:z.environment.raycastVersion},system:{arch:s,version:o,buildVersion:i},node:{arch:process.arch,version:process.version},cli:{type:n.type,version:c},preferences:r};if(G==="macos"){let p=await wa();u.homebrew={arch:p.arch,version:p.version}}await z.Clipboard.copy(JSON.stringify(u,null,2)),e.style=z.Toast.Style.Success,e.title="Data copied to clipboard"}catch(r){e.style=z.Toast.Style.Failure,e.title="Failed to collect bug report data",w("Failed to collect bug report data",r)}};return(0,yo.jsx)(z.Action,{title:"Collect Bug Report Data",icon:z.Icon.Bug,onAction:t})}var ct=ba;var wo=require("@raycast/api"),bo=require("react/jsx-runtime"),Cr="https://github.com/raycast/extensions/issues/new?assignees=&labels=extension%2Cbug&template=extension_bug_report.yml&title=%5BBitwarden%5D+...";function Ea(){return(0,bo.jsx)(wo.Action.OpenInBrowser,{title:"Open Bug Report",url:Cr})}var lt=Ea;var H=require("@raycast/api");var Eo=require("react/jsx-runtime");function Sa(){return(0,Eo.jsx)(H.Action,{onAction:async()=>{let e=Be.toString();if(e.length===0)return(0,H.showToast)(H.Toast.Style.Success,"No errors to copy");await H.Clipboard.copy(e),await(0,H.showToast)(H.Toast.Style.Success,"Errors copied to clipboard"),await(0,H.confirmAlert)({title:"Be careful with this information",message:"Please be mindful of where you share this error log, as it may contain sensitive information. Always analyze it before sharing.",primaryAction:{title:"Got it",style:H.Alert.ActionStyle.Default}})},title:"Copy Last Errors",icon:H.Icon.CopyClipboard,style:H.Action.Style.Regular})}var Lr=Sa;var Io=require("@raycast/api");var So=require("react");var xa=()=>{let t=ue.get(fe.CLI_VERSION);return t?parseFloat(t):-1},xo=()=>{let[t,e]=(0,So.useState)(xa);return we(()=>{ue.subscribe((r,n)=>{n&&r===fe.CLI_VERSION&&e(parseFloat(n)||-1)})}),t};var He=require("react/jsx-runtime");function ot(){let t=xo();return(0,He.jsxs)(Io.ActionPanel.Section,{title:`Debugging & Bug Reporting (CLI v${t})`,children:[(0,He.jsx)(Lr,{}),(0,He.jsx)(lt,{}),(0,He.jsx)(ct,{})]})}var je=require("@raycast/api");var Bt=require("@raycast/api"),dt=require("react");var ut=require("react");var va=require("react/jsx-runtime"),pd=(0,ut.createContext)(null);var ka=require("@raycast/api");var Ta=require("@raycast/api");var $a=require("react");var Pa=require("react/jsx-runtime"),Hd=(0,dt.createContext)(null);var{syncOnLaunch:jd}=(0,Bt.getPreferenceValues)();var vo=require("react/jsx-runtime");var Se=require("react/jsx-runtime"),Ca=`

`,Ar="https://bitwarden.com/help/cli/#download-and-install",La=t=>`\`\`\`
${t}
\`\`\``,Aa=({error:t})=>{let e=Pt(t),r=(0,re.getPreferenceValues)().cliPath,n=t instanceof ve,s=r||t instanceof me,o=[];if(s&&!n?o.push("# \u26A0\uFE0F Bitwarden CLI not found"):o.push("# \u{1F4A5} Whoops! Something went wrong"),n)o.push(`We couldn't download the [Bitwarden CLI](${Ar}), you can always install it on your machine.`);else if(s){let i=r?` (${r})`:"";o.push(`We couldn't find the [Bitwarden CLI](${Ar}) installed on your machine${i}.`)}else o.push(`The \`${re.environment.commandName}\` command crashed when we were not expecting it to.`);if(o.push("> Please read the `Setup` section in the [extension's description](https://www.raycast.com/jomifepe/bitwarden) to ensure that everything is properly configured."),o.push(`**Try restarting the command. If the issue persists, consider [reporting a bug on GitHub](${Cr}) to help us fix it.**`),e){let i=/incompatible architecture/gi.test(e);o.push(">## Technical details \u{1F913}",i&&`\u26A0\uFE0F We suspect that your Bitwarden CLI was installed using a version of NodeJS that's incompatible with your system architecture (e.g. x64 NodeJS on a M1/Apple Silicon Mac). Please make sure your have the correct versions of your software installed (e.g., ${G==="macos"?"Homebrew, ":""}NodeJS, and Bitwarden CLI).`,La(e))}return(0,Se.jsx)(re.Detail,{markdown:o.filter(Boolean).join(Ca),actions:(0,Se.jsxs)(re.ActionPanel,{children:[(0,Se.jsxs)(re.ActionPanel.Section,{title:"Bug Report",children:[(0,Se.jsx)(lt,{}),(0,Se.jsx)(ct,{})]}),s&&(0,Se.jsx)(re.Action.OpenInBrowser,{title:"Open Installation Guide",url:Ar})]})})},ft=Aa;var Gt=require("react/jsx-runtime"),To=(0,Le.createContext)(null),$o=({children:t,loadingFallback:e=(0,Gt.jsx)(Ms,{})})=>{let[r,n]=(0,Le.useState)(),[s,o]=(0,Le.useState)();we(()=>{new _t().initialize().then(n).catch(i)});function i(c){if(c instanceof me)o(c);else throw c}return s?(0,Gt.jsx)(ft,{error:s}):r?(0,Gt.jsx)(To.Provider,{value:r,children:t}):e},oe=()=>{let t=(0,Le.useContext)(To);if(t==null)throw new Error("useBitwarden must be used within a BitwardenProvider");return t};var Ke=require("@raycast/api"),ko=require("react");var Rr=require("react/jsx-runtime"),mt=class extends ko.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}async componentDidCatch(e,r){e instanceof ce?(this.setState(n=>({...n,hasError:!0,error:e.message})),await(0,Ke.showToast)(Ke.Toast.Style.Failure,e.message)):(Ke.environment.isDevelopment&&this.setState(n=>({...n,hasError:!0,error:e.message})),console.error("Error:",e,r))}render(){try{return this.state.hasError?(0,Rr.jsx)(ft,{error:this.state.error}):this.props.children}catch{return(0,Rr.jsx)(ft,{})}}};var ne=require("react/jsx-runtime"),Ra=()=>(0,ne.jsx)(mt,{children:(0,ne.jsx)($o,{children:(0,ne.jsx)($r,{unlock:!0,children:(0,ne.jsx)(Oa,{})})})});function Oa(){let t=oe(),{handleSubmit:e,itemProps:r}=Js({onSubmit:async n=>{let s=await(0,Y.showToast)({title:"Creating Folder...",style:Y.Toast.Style.Animated});try{let{error:o}=await t.createFolder(n.name);if(o)throw o;s.style=Y.Toast.Style.Success,s.title="Folder created",s.message=n.name}catch{s.style=Y.Toast.Style.Failure,s.title="Failed to create folder",s.message=void 0}},validation:{name:qs.Required}});return(0,ne.jsx)(Y.Form,{actions:(0,ne.jsxs)(Y.ActionPanel,{children:[(0,ne.jsx)(Y.Action.SubmitForm,{title:"Create Folder",onSubmit:e,icon:Y.Icon.NewFolder}),(0,ne.jsx)(ot,{})]}),children:(0,ne.jsx)(Y.Form.TextField,{title:"Folder Name",placeholder:"eg: Personal, Work",autoFocus:!0,...r.name})})}var _a=Ra;
/*! Bundled license information:

node-stream-zip/node_stream_zip.js:
  (**
   * @license node-stream-zip | (c) 2020 Antelle | https://github.com/antelle/node-stream-zip/blob/master/LICENSE
   * Portions copyright https://github.com/cthackers/adm-zip | https://raw.githubusercontent.com/cthackers/adm-zip/master/LICENSE
   *)
*/
